2025-08-30 10:16:35,699 - chatbot_logger - INFO - Initializing chatbot backend...
2025-08-30 10:16:35,699 - chatbot_logger - INFO - metadata.json found. Clearing existing vector store before re-initialization.
2025-08-30 10:16:35,699 - chatbot_logger - INFO - Vector store cleared.
2025-08-30 10:16:35,699 - chatbot_logger - INFO - Existing vector store cleared based on metadata.json presence.
2025-08-30 10:16:35,865 - chatbot_logger - DEBUG - Initialized 5 KB chunks.
2025-08-30 10:16:35,865 - chatbot_logger - INFO - KB chunks initialized/re-initialized.
2025-08-30 10:16:35,865 - chatbot_logger - DEBUG - Loaded Profile for ABC:
{
  "user_id": "ABC",
  "demographics": {},
  "conditions": [],
  "preferences": {
    "tone": "genuine",
    "length": "short",
    "avoid_topics": []
  },
  "goals": [],
  "triggers": [],
  "therapeutic_styles": [
    "CBT",
    "Mindfulness"
  ],
  "timezone": "UTC",
  "safety_plan": {
    "contacts": [],
    "grounding_preference": ""
  },
  "consents": {
    "data_use": true,
    "crisis_detection": true
  },
  "updated_at": "2025-08-30T10:16:35.865634"
}
2025-08-30 10:16:48,287 - chatbot_logger - DEBUG - Detected User Emotion: sadness (Scores: {"sadness": 0.9635407328605652, "fear": 0.01418975181877613, "anger": 0.009427613578736782, "joy": 0.005386797245591879, "neutral": 0.0035100497771054506, "surprise": 0.0034611066803336143, "disgust": 0.0004840102919843048})
2025-08-30 10:16:48,707 - chatbot_logger - INFO - User Query (ABC): i need help!
2025-08-30 10:16:48,707 - chatbot_logger - INFO - Assistant Response (ABC): I'm here to support you. It takes a lot of courage to reach out for help, and I'm glad you did. I'm not a professional counselor, but I'm here to listen and offer some guidance.

It seems like you're currently feeling quite sad (0.9635407328605652). Would you like to talk about what's been going on that's making you feel this way? Sometimes sharing what's on your mind can help you feel a bit better.

We can take this conversation at your pace, and I'll do my best to offer support and suggestions based on your preferences for CBT and Mindfulness. Remember, everything we discuss is confidential and for your benefit only.

Please feel free to share as much or as little as you're comfortable with. I'm here to listen and help if I can.
2025-08-30 10:16:49,491 - chatbot_logger - DEBUG - Profile Update (Option 3): Added new avoid topic 'distress' for user ABC due to negative emotion.
2025-08-30 10:16:49,491 - chatbot_logger - INFO - User ABC profile will be updated with new avoid topics: ['distress']
2025-08-30 10:16:49,491 - chatbot_logger - DEBUG - Final profile_patch for user ABC: {
  "goals": [],
  "conditions": [],
  "preferences": {
    "tone": "genuine",
    "length": "short",
    "avoid_topics": [
      "distress"
    ]
  }
}
2025-08-30 10:16:49,491 - chatbot_logger - INFO - User ABC profile updated with aggregated changes: {'goals': [], 'conditions': [], 'preferences': {'tone': 'genuine', 'length': 'short', 'avoid_topics': ['distress']}}
2025-08-30 10:16:49,491 - chatbot_logger - DEBUG - Updated Profile for ABC:
{
  "user_id": "ABC",
  "demographics": {},
  "conditions": [],
  "preferences": {
    "tone": "genuine",
    "length": "short",
    "avoid_topics": [
      "distress"
    ]
  },
  "goals": [],
  "triggers": [],
  "therapeutic_styles": [
    "CBT",
    "Mindfulness"
  ],
  "timezone": "UTC",
  "safety_plan": {
    "contacts": [],
    "grounding_preference": ""
  },
  "consents": {
    "data_use": true,
    "crisis_detection": true
  },
  "updated_at": "2025-08-30T10:16:49.491182"
}
2025-08-30 10:17:21,056 - chatbot_logger - DEBUG - Detected User Emotion: joy (Scores: {"joy": 0.9372196793556213, "surprise": 0.04802706465125084, "neutral": 0.005088268779218197, "sadness": 0.00455921795219183, "anger": 0.003833377966657281, "fear": 0.0009977644076570868, "disgust": 0.00027474240050651133})
2025-08-30 10:17:22,272 - chatbot_logger - INFO - User Query (ABC): i won 2 billion dollars and need to know what to do!
2025-08-30 10:17:22,272 - chatbot_logger - INFO - Assistant Response (ABC): Congratulations on your incredible win! That's truly life-changing news! I'm thrilled to help you navigate this exciting and overwhelming experience.

Firstly, take a moment to acknowledge and celebrate your good fortune. It's essential to acknowledge and process your emotions, especially in this moment. I'm here to support you, and we can work through this together.

Now, let's break down some essential steps to help you make the most of this windfall:

1. Take a deep breath and prioritize your safety: Ensure you have access to a secure and stable financial institution to manage your new wealth.
2. Consult with a financial advisor: They can help you create a comprehensive plan to manage your newfound wealth, considering tax implications, investments, and estate planning.
3. Consider setting up a foundation or charitable organization: Many individuals use their wealth to make a positive impact on their community or the world. This can be a fulfilling way to give back and make a lasting difference.
4. Plan for your future: Think about how you want to use your wealth to enhance your life, whether that's through travel, education, or personal goals.
5. Take care of yourself: Remember to prioritize your mental and emotional well-being during this significant life change. It's essential to maintain a healthy work-life balance and seek support when needed.

As we explore these steps together, I want to emphasize the importance of self-care and mindfulness during this time. It's natural to feel overwhelmed, but by breaking things down and focusing on your goals, you can create a clear path forward.

How do you feel about tackling these steps, and are there any specific areas you'd like to focus on first?
2025-08-30 10:17:22,515 - chatbot_logger - ERROR - Error during LLM-based goal/condition extraction: Error code: 400 - {'error': {'message': "Failed to call a function. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'tool_use_failed', 'failed_generation': '<tool-use>\n{\n"tool_call": {\n"id": "pending",\n"type": "function",\n"function": {\n"name": "GoalConditionExtraction"\n},\n"parameters": {\n"properties": {\n"conditions": [],\n"goals": [\n"financial planning",\n"stress management",\n"overwhelm management"\n]\n}\n}\n}\n</tool-use>'}}
2025-08-30 10:17:22,515 - chatbot_logger - DEBUG - No profile updates detected for user ABC this turn.
2025-08-30 10:17:22,530 - chatbot_logger - DEBUG - Updated Profile for ABC:
{
  "user_id": "ABC",
  "demographics": {},
  "conditions": [],
  "preferences": {
    "tone": "genuine",
    "length": "short",
    "avoid_topics": [
      "distress"
    ]
  },
  "goals": [],
  "triggers": [],
  "therapeutic_styles": [
    "CBT",
    "Mindfulness"
  ],
  "timezone": "UTC",
  "safety_plan": {
    "contacts": [],
    "grounding_preference": ""
  },
  "consents": {
    "data_use": true,
    "crisis_detection": true
  },
  "updated_at": "2025-08-30T10:16:49.491182"
}
2025-08-30 10:18:20,692 - chatbot_logger - DEBUG - Detected User Emotion: fear (Scores: {"fear": 0.9940127730369568, "sadness": 0.002615127246826887, "anger": 0.0013858601450920105, "joy": 0.0008571708458475769, "surprise": 0.0007128111901693046, "neutral": 0.0002713536669034511, "disgust": 0.0001449180708732456})
2025-08-30 10:18:21,076 - chatbot_logger - INFO - User Query (ABC): i am scared if i lose this money
2025-08-30 10:18:21,076 - chatbot_logger - INFO - Assistant Response (ABC): I'm so sorry to hear that you're feeling scared about losing the money. It's completely understandable to feel overwhelmed by the sudden influx of wealth. It's normal to have concerns about how to manage and protect your newfound resources.

Can you tell me more about what's specifically causing you fear? Is it the thought of losing the money, worrying about how to invest it, or something else entirely?
2025-08-30 10:18:21,318 - chatbot_logger - DEBUG - Profile Update (Option 2): Added new goal 'Financial security' for user ABC.
2025-08-30 10:18:21,318 - chatbot_logger - DEBUG - Profile Update (Option 2): Added new goal 'Avoiding financial loss' for user ABC.
2025-08-30 10:18:21,318 - chatbot_logger - DEBUG - Profile Update (Option 2): Added new condition 'Anxiety' for user ABC.
2025-08-30 10:18:21,318 - chatbot_logger - INFO - User ABC profile will be updated with new goals/conditions.
2025-08-30 10:18:21,897 - chatbot_logger - DEBUG - Profile Update (Option 3): Added new avoid topic 'financial loss' for user ABC due to negative emotion.
2025-08-30 10:18:21,897 - chatbot_logger - DEBUG - Profile Update (Option 3): Added new avoid topic 'anxiety' for user ABC due to negative emotion.
2025-08-30 10:18:21,897 - chatbot_logger - DEBUG - Profile Update (Option 3): Added new avoid topic 'fear of losing money' for user ABC due to negative emotion.
2025-08-30 10:18:21,897 - chatbot_logger - INFO - User ABC profile will be updated with new avoid topics: ['financial loss', 'fear of losing money', 'distress', 'anxiety']
2025-08-30 10:18:21,897 - chatbot_logger - DEBUG - Final profile_patch for user ABC: {
  "goals": [
    "Financial security",
    "Avoiding financial loss"
  ],
  "conditions": [
    "Anxiety"
  ],
  "preferences": {
    "tone": "genuine",
    "length": "short",
    "avoid_topics": [
      "financial loss",
      "fear of losing money",
      "distress",
      "anxiety"
    ]
  }
}
2025-08-30 10:18:21,897 - chatbot_logger - INFO - User ABC profile updated with aggregated changes: {'goals': ['Financial security', 'Avoiding financial loss'], 'conditions': ['Anxiety'], 'preferences': {'tone': 'genuine', 'length': 'short', 'avoid_topics': ['financial loss', 'fear of losing money', 'distress', 'anxiety']}}
2025-08-30 10:18:21,913 - chatbot_logger - DEBUG - Updated Profile for ABC:
{
  "user_id": "ABC",
  "demographics": {},
  "conditions": [
    "Anxiety"
  ],
  "preferences": {
    "tone": "genuine",
    "length": "short",
    "avoid_topics": [
      "financial loss",
      "fear of losing money",
      "distress",
      "anxiety"
    ]
  },
  "goals": [
    "Financial security",
    "Avoiding financial loss"
  ],
  "triggers": [],
  "therapeutic_styles": [
    "CBT",
    "Mindfulness"
  ],
  "timezone": "UTC",
  "safety_plan": {
    "contacts": [],
    "grounding_preference": ""
  },
  "consents": {
    "data_use": true,
    "crisis_detection": true
  },
  "updated_at": "2025-08-30T10:18:21.897947"
}
